<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Zoo Keeper Pro">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" sizes="180x180" href="icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icon.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon.png">
    <meta name="theme-color" content="#0a0e1a">
    <title>Zoo Keeper</title>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
/* MODERN HOME SCREEN - CLEAN & WORKING */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: 'Inter', -apple-system, sans-serif;
    background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    overflow: hidden;
    height: 100vh;
}

#gameContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: radial-gradient(ellipse at top, #1a1f35 0%, #0a0e1a 100%);
    overflow: hidden;
}

canvas {
    display: block;
    width: 100%;
    height: 100%;
    background: linear-gradient(180deg, #0f1729 0%, #1a2332 40%, #2d3748 100%);
    touch-action: none;
}

/* HOME SCREEN OVERLAY */
#overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(10, 14, 26, 0.95);
    backdrop-filter: blur(20px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.modal {
    background: rgba(30, 41, 59, 0.95);
    border: 1px solid rgba(148, 163, 184, 0.3);
    border-radius: 24px;
    padding: 48px 32px;
    width: 90%;
    max-width: 400px;
    max-height: 90vh;
    text-align: center;
    box-shadow: 0 24px 48px rgba(0, 0, 0, 0.6);
    overflow-y: auto;
}

/* Modern Blue-Purple-Pink Gradient Title */
h1 {
    font-size: 52px;
    font-weight: 900;
    background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 50%, #ec4899 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 12px;
    letter-spacing: -1px;
    line-height: 1;
}

.subtitle {
    font-size: 15px;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 24px;
    font-weight: 500;
}

.animal-emojis {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 24px;
    padding: 16px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 16px;
}

.animal-emoji {
    font-size: 36px;
}

/* Modern Blue Buttons */
button {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
    border: none;
    padding: 16px 32px;
    font-size: 16px;
    font-weight: 700;
    border-radius: 14px;
    cursor: pointer;
    margin-top: 12px;
    width: 100%;
    box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);
    transition: transform 0.2s;
    font-family: 'Inter', sans-serif;
}

button:active {
    transform: scale(0.97);
}

#premiumBtn {
    background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
    box-shadow: 0 8px 24px rgba(245, 158, 11, 0.3);
}

#premiumStatus {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    padding: 16px;
    border-radius: 14px;
    margin-top: 12px;
}

button.secondary {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.15);
    box-shadow: none;
}

.firebase-status {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.5);
    margin: 16px 0;
}

.firebase-status.connected {
    color: #10b981;
}

/* GAME HUD */
#hud {
    position: absolute;
    top: 15px;
    left: 0;
    right: 0;
    padding: 0 15px;
    display: flex;
    justify-content: space-between;
    z-index: 100;
}

.stat-box {
    background: rgba(15, 20, 35, 0.9);
    border: 1px solid rgba(102, 126, 234, 0.25);
    border-radius: 16px;
    padding: 12px 18px;
    min-width: 85px;
    backdrop-filter: blur(20px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
}

.stat-label {
    font-size: 9px;
    color: rgba(255, 255, 255, 0.5);
    text-transform: uppercase;
    letter-spacing: 1.2px;
    margin-bottom: 5px;
    font-weight: 600;
}

.stat-value {
    font-size: 28px;
    font-weight: 800;
    background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
}

.lives {
    display: flex;
    gap: 6px;
    margin-top: 5px;
}

.heart {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
    box-shadow: 0 0 12px rgba(96, 165, 250, 0.7);
}

.heart.lost {
    background: rgba(255, 255, 255, 0.1);
    box-shadow: none;
}

#pauseButton {
    position: absolute;
    top: 15px;
    left: 50%;
    transform: translateX(-50%);
    width: 48px;
    height: 48px;
    background: rgba(15, 20, 35, 0.9);
    border: 1px solid rgba(102, 126, 234, 0.25);
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 26px;
    z-index: 150;
    cursor: pointer;
}

.hidden {
    display: none !important;
}

/* Safe area support for iPhone notch */
@supports (padding: env(safe-area-inset-top)) {
    #hud {
        top: calc(15px + env(safe-area-inset-top));
    }
    #pauseButton {
        top: calc(15px + env(safe-area-inset-top));
    }
}
    </style>
</head>
<body>
    <div id="gameContainer">
        <div id="hud">
            <div class="stat-box">
                <div class="stat-label">SCORE</div>
                <div class="stat-value" id="scoreDisplay">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">LIVES</div>
                <div class="lives" id="livesDisplay">
                    <div class="heart"></div>
                    <div class="heart"></div>
                    <div class="heart"></div>
                </div>
            </div>
        </div>
        <div id="pauseButton">‚è∏Ô∏è</div>
        <canvas id="gameCanvas"></canvas>
    </div>

    <div id="overlay">
        <div class="modal">
            <h1>Zoo Keeper</h1>
            <p class="subtitle">Catch rare animals and build your ultimate zoo!</p>

            <div class="animal-emojis">
                <span class="animal-emoji">ü¶ä</span>
                <span class="animal-emoji">üê®</span>
                <span class="animal-emoji">üêº</span>
                <span class="animal-emoji">ü¶Å</span>
                <span class="animal-emoji">üêØ</span>
                <span class="animal-emoji">üêª</span>
            </div>

            <p class="firebase-status" id="firebaseStatus">Connecting...</p>

            <button id="startBtn">‚ñ∂Ô∏è Start Playing</button>
            <button id="premiumBtn">üíé Unlock Premium</button>
            <div id="premiumStatus" class="hidden">üíé Premium Active</div>
            <button class="secondary" id="statsBtn">üìä Stats</button>
            <button class="secondary" id="leaderboardBtn">üèÜ Leaderboard</button>
        </div>
    </div>

    <script>
    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyDWLgSdmM1E3Mq0oVQK3H6UfvJWv0A8HM",
        authDomain: "zookeeper-b75c4.firebaseapp.com",
        databaseURL: "https://zookeeper-b75c4-default-rtdb.firebaseio.com",
        projectId: "zookeeper-b75c4",
        storageBucket: "zookeeper-b75c4.firebasestorage.app",
        messagingSenderId: "424082143710",
        appId: "1:424082143710:web:8b51fe37c4fbed77cbb2d6"
    };

    let database;
    let firebaseInitialized = false;

    try {
        firebase.initializeApp(firebaseConfig);
        database = firebase.database();
        firebaseInitialized = true;
        document.getElementById('firebaseStatus').textContent = '‚úÖ Connected';
        document.getElementById('firebaseStatus').classList.add('connected');
    } catch (error) {
        console.error('Firebase failed:', error);
        document.getElementById('firebaseStatus').textContent = '‚ö†Ô∏è Offline mode';
    }

    // Game Variables
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    let gameWidth = window.innerWidth;
    let gameHeight = window.innerHeight;
    let gameRunning = false;
    let score = 0;
    let lives = 3;
    let animals = [];
    let player = { x: gameWidth / 2 - 40, y: gameHeight - 110, width: 80 };
    let isDragging = false;

    function resizeCanvas() {
        gameWidth = window.innerWidth;
        gameHeight = window.innerHeight;
        canvas.width = gameWidth;
        canvas.height = gameHeight;
        player.y = gameHeight - 110;
    }

    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    // Start Game
    document.getElementById('startBtn').addEventListener('click', function() {
        console.log('Start button clicked!');
        initAudio();
        document.getElementById('overlay').classList.add('hidden');
        startGame();
    });

    function startGame() {
        gameRunning = true;
        score = 0;
        lives = 3;
        animals = [];
        updateScore();
        updateLives();
        gameLoop();
    }

    function gameLoop() {
        if (!gameRunning) return;

        ctx.fillStyle = '#0a0e1a';
        ctx.fillRect(0, 0, gameWidth, gameHeight);

        // Spawn animals
        if (Math.random() < 0.02) {
            animals.push({
                x: Math.random() * (gameWidth - 40),
                y: -50,
                emoji: ['ü¶ä', 'üê®', 'üêº', 'ü¶Å'][Math.floor(Math.random() * 4)],
                speed: 2
            });
        }

        // Update and draw animals
        animals.forEach((animal, index) => {
            animal.y += animal.speed;

            ctx.font = '40px Arial';
            ctx.fillText(animal.emoji, animal.x, animal.y);

            // Check collision with player
            if (animal.y > player.y && animal.y < player.y + 40 &&
                animal.x > player.x && animal.x < player.x + 80) {
                animals.splice(index, 1);
                score += 10;
                updateScore();
                playSound(440, 0.1);
            }

            // Remove if off screen
            if (animal.y > gameHeight) {
                animals.splice(index, 1);
                lives--;
                updateLives();
                if (lives <= 0) {
                    gameOver();
                    return;
                }
            }
        });

        // Draw player basket
        ctx.fillStyle = '#3b82f6';
        ctx.fillRect(player.x, player.y, player.width, 40);
        ctx.font = '30px Arial';
        ctx.fillText('üß∫', player.x + 25, player.y + 30);

        requestAnimationFrame(gameLoop);
    }

    function updateScore() {
        document.getElementById('scoreDisplay').textContent = score;
    }

    function updateLives() {
        const hearts = document.querySelectorAll('.heart');
        hearts.forEach((heart, i) => {
            if (i < lives) {
                heart.classList.remove('lost');
            } else {
                heart.classList.add('lost');
            }
        });
    }

    function gameOver() {
        gameRunning = false;
        alert('Game Over! Score: ' + score);
        document.getElementById('overlay').classList.remove('hidden');
    }

    // Touch Controls - FIXED
    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        const rect = canvas.getBoundingClientRect();
        player.x = Math.max(0, Math.min(gameWidth - 80, touch.clientX - rect.left - 40));
        isDragging = true;
    });

    canvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        if (isDragging) {
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            player.x = Math.max(0, Math.min(gameWidth - 80, touch.clientX - rect.left - 40));
        }
    });

    canvas.addEventListener('touchend', () => {
        isDragging = false;
    });

    // Mouse Controls
    canvas.addEventListener('mousedown', (e) => {
        const rect = canvas.getBoundingClientRect();
        player.x = Math.max(0, Math.min(gameWidth - 80, e.clientX - rect.left - 40));
        isDragging = true;
    });

    canvas.addEventListener('mousemove', (e) => {
        if (isDragging) {
            const rect = canvas.getBoundingClientRect();
            player.x = Math.max(0, Math.min(gameWidth - 80, e.clientX - rect.left - 40));
        }
    });

    canvas.addEventListener('mouseup', () => {
        isDragging = false;
    });

    // Pause Button
    document.getElementById('pauseButton').addEventListener('click', () => {
        gameRunning = !gameRunning;
        if (gameRunning) {
            gameLoop();
        }
    });

    // Simple Audio
    let audioCtx = null;
    function initAudio() {
        if (!audioCtx) {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
    }

    function playSound(freq, duration) {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.frequency.value = freq;
        gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }

    // Premium Button (placeholder)
    document.getElementById('premiumBtn').addEventListener('click', () => {
        alert('Premium feature - implement IAP here');
    });

    // Stats Button (placeholder)
    document.getElementById('statsBtn').addEventListener('click', () => {
        alert('Stats screen - to be implemented');
    });

    // Leaderboard Button (placeholder)
    document.getElementById('leaderboardBtn').addEventListener('click', () => {
        alert('Leaderboard - to be implemented');
    });
    </script>
</body>
</html>
